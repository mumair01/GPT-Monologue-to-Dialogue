Fri Jul  8 13:11:13 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-PCIE...  On   | 00000000:AF:00.0 Off |                    0 |
| N/A   30C    P0    22W / 250W |      0MiB / 32510MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
{'dataset': {'custom': False,
             'name': 'in_conversation_corpus_poc',
             'train_path': 'data/datasets/processed/ICC/julia_dissertation/train.txt',
             'val_path': 'data/datasets/processed/ICC/julia_dissertation/validation.txt'},
 'env': {'seed': None},
 'name': '1.0-GPT-Finetune-TextDataset-HPC',
 'results': {'reports_dir': 'data/models/1.0-GPT-Finetune-TextDataset-HPC/textDataset',
             'save_dir': 'data/models/1.0-GPT-Finetune-TextDataset-HPC/textDataset'},
 'root': '/cluster/tufts/deruiterlab/mumair01/projects/gpt_monologue_dialogue',
 'training': {'data_block_size': 128,
              'model_checkpoint': 'gpt2-large',
              'num_train_epochs': 30,
              'per_device_eval_batch_size': 16,
              'per_device_train_batch_size': 16,
              'tokenizer_additional_special_tokens': ['<SP1>',
                                                      '<SP2>',
                                                      '<START>',
                                                      '<END>'],
              'tokenizer_checkpoint': 'gpt2',
              'warmup_steps': 300}}
2022-07-08 13:11:29,127 | __main__ | INFO | Using device cuda
2022-07-08 13:11:29,127 | __main__ | INFO | Loading tokenizer: gpt2
2022-07-08 13:11:30,151 | __main__ | INFO | Loading data as TextDataset...
2022-07-08 13:11:30,151 | __main__ | WARNING | TextDataset expects .txt files.
2022-07-08 13:11:30,329 | __main__ | INFO | Tokenizer length after loading datasets: 50262
2022-07-08 13:11:30,329 | __main__ | INFO | Creating data collator.
2022-07-08 13:11:30,329 | __main__ | INFO | Loading model: gpt2-large
2022-07-08 13:11:38,623 | __main__ | INFO | Resizing model embeddings to 50262
2022-07-08 13:11:39,320 | __main__ | INFO | Preparing training arguments.
2022-07-08 13:11:39,322 | __main__ | INFO | Initializing Trainer
2022-07-08 13:11:45,178 | __main__ | INFO | Clearing CUDA cache
2022-07-08 13:11:45,272 | __main__ | INFO | Starting training...
{'loss': 4.3019, 'learning_rate': 7.000000000000001e-06, 'epoch': 1.0}
{'eval_loss': 2.9279704093933105, 'eval_runtime': 45.9626, 'eval_samples_per_second': 50.432, 'eval_steps_per_second': 3.155, 'epoch': 1.0}
{'loss': 2.8039, 'learning_rate': 1.4000000000000001e-05, 'epoch': 2.0}
{'eval_loss': 2.7381527423858643, 'eval_runtime': 46.1355, 'eval_samples_per_second': 50.243, 'eval_steps_per_second': 3.143, 'epoch': 2.0}
{'loss': 2.5833, 'learning_rate': 2.1e-05, 'epoch': 3.0}
{'eval_loss': 2.7019574642181396, 'eval_runtime': 46.151, 'eval_samples_per_second': 50.226, 'eval_steps_per_second': 3.142, 'epoch': 3.0}
{'loss': 2.3623, 'learning_rate': 2.8000000000000003e-05, 'epoch': 4.0}
{'eval_loss': 2.6611762046813965, 'eval_runtime': 46.1755, 'eval_samples_per_second': 50.2, 'eval_steps_per_second': 3.14, 'epoch': 4.0}
{'loss': 2.0832, 'learning_rate': 3.5e-05, 'epoch': 5.0}
{'eval_loss': 2.725615978240967, 'eval_runtime': 46.1521, 'eval_samples_per_second': 50.225, 'eval_steps_per_second': 3.142, 'epoch': 5.0}
{'loss': 1.7929, 'learning_rate': 4.2e-05, 'epoch': 6.0}
{'eval_loss': 2.8255388736724854, 'eval_runtime': 46.1621, 'eval_samples_per_second': 50.214, 'eval_steps_per_second': 3.141, 'epoch': 6.0}
{'loss': 1.4918, 'learning_rate': 4.9e-05, 'epoch': 7.0}
{'eval_loss': 2.974971055984497, 'eval_runtime': 46.13, 'eval_samples_per_second': 50.249, 'eval_steps_per_second': 3.143, 'epoch': 7.0}
{'loss': 1.1936, 'learning_rate': 4.8125000000000004e-05, 'epoch': 8.0}
{'eval_loss': 3.131722927093506, 'eval_runtime': 46.1415, 'eval_samples_per_second': 50.237, 'eval_steps_per_second': 3.143, 'epoch': 8.0}
{'loss': 0.9188, 'learning_rate': 4.59375e-05, 'epoch': 9.0}
{'eval_loss': 3.291473627090454, 'eval_runtime': 46.1517, 'eval_samples_per_second': 50.226, 'eval_steps_per_second': 3.142, 'epoch': 9.0}
{'loss': 0.6987, 'learning_rate': 4.375e-05, 'epoch': 10.0}
{'eval_loss': 3.4339871406555176, 'eval_runtime': 46.1344, 'eval_samples_per_second': 50.245, 'eval_steps_per_second': 3.143, 'epoch': 10.0}
{'loss': 0.5308, 'learning_rate': 4.156250000000001e-05, 'epoch': 11.0}
{'eval_loss': 3.5887651443481445, 'eval_runtime': 46.1807, 'eval_samples_per_second': 50.194, 'eval_steps_per_second': 3.14, 'epoch': 11.0}
{'loss': 0.4052, 'learning_rate': 3.9375e-05, 'epoch': 12.0}
{'eval_loss': 3.739624261856079, 'eval_runtime': 46.1532, 'eval_samples_per_second': 50.224, 'eval_steps_per_second': 3.142, 'epoch': 12.0}
{'loss': 0.3051, 'learning_rate': 3.71875e-05, 'epoch': 13.0}
{'eval_loss': 3.875495433807373, 'eval_runtime': 46.177, 'eval_samples_per_second': 50.198, 'eval_steps_per_second': 3.14, 'epoch': 13.0}
{'loss': 0.2417, 'learning_rate': 3.5e-05, 'epoch': 14.0}
{'eval_loss': 3.947622776031494, 'eval_runtime': 46.165, 'eval_samples_per_second': 50.211, 'eval_steps_per_second': 3.141, 'epoch': 14.0}
{'loss': 0.1943, 'learning_rate': 3.2812500000000005e-05, 'epoch': 15.0}
{'eval_loss': 4.057458400726318, 'eval_runtime': 46.169, 'eval_samples_per_second': 50.207, 'eval_steps_per_second': 3.141, 'epoch': 15.0}
{'loss': 0.1636, 'learning_rate': 3.0625000000000006e-05, 'epoch': 16.0}
{'eval_loss': 4.118574619293213, 'eval_runtime': 46.155, 'eval_samples_per_second': 50.222, 'eval_steps_per_second': 3.142, 'epoch': 16.0}
{'loss': 0.1356, 'learning_rate': 2.84375e-05, 'epoch': 17.0}
{'eval_loss': 4.189087390899658, 'eval_runtime': 46.1461, 'eval_samples_per_second': 50.232, 'eval_steps_per_second': 3.142, 'epoch': 17.0}
{'loss': 0.1173, 'learning_rate': 2.625e-05, 'epoch': 18.0}
{'eval_loss': 4.264614105224609, 'eval_runtime': 46.1563, 'eval_samples_per_second': 50.221, 'eval_steps_per_second': 3.141, 'epoch': 18.0}
{'loss': 0.1025, 'learning_rate': 2.4062500000000002e-05, 'epoch': 19.0}
{'eval_loss': 4.296379566192627, 'eval_runtime': 46.1584, 'eval_samples_per_second': 50.218, 'eval_steps_per_second': 3.141, 'epoch': 19.0}
{'loss': 0.0865, 'learning_rate': 2.1875e-05, 'epoch': 20.0}
{'eval_loss': 4.3545732498168945, 'eval_runtime': 46.168, 'eval_samples_per_second': 50.208, 'eval_steps_per_second': 3.141, 'epoch': 20.0}
{'loss': 0.0761, 'learning_rate': 1.96875e-05, 'epoch': 21.0}
{'eval_loss': 4.403324604034424, 'eval_runtime': 46.1521, 'eval_samples_per_second': 50.225, 'eval_steps_per_second': 3.142, 'epoch': 21.0}
{'loss': 0.0694, 'learning_rate': 1.75e-05, 'epoch': 22.0}
{'eval_loss': 4.459542274475098, 'eval_runtime': 46.1619, 'eval_samples_per_second': 50.215, 'eval_steps_per_second': 3.141, 'epoch': 22.0}
{'loss': 0.0586, 'learning_rate': 1.5312500000000003e-05, 'epoch': 23.0}
{'eval_loss': 4.507935523986816, 'eval_runtime': 46.1636, 'eval_samples_per_second': 50.213, 'eval_steps_per_second': 3.141, 'epoch': 23.0}
{'loss': 0.0542, 'learning_rate': 1.3125e-05, 'epoch': 24.0}
{'eval_loss': 4.560030937194824, 'eval_runtime': 46.157, 'eval_samples_per_second': 50.22, 'eval_steps_per_second': 3.141, 'epoch': 24.0}
{'loss': 0.0484, 'learning_rate': 1.09375e-05, 'epoch': 25.0}
{'eval_loss': 4.570046901702881, 'eval_runtime': 46.1701, 'eval_samples_per_second': 50.206, 'eval_steps_per_second': 3.141, 'epoch': 25.0}
{'loss': 0.0464, 'learning_rate': 8.75e-06, 'epoch': 26.0}
{'eval_loss': 4.592435359954834, 'eval_runtime': 46.1692, 'eval_samples_per_second': 50.207, 'eval_steps_per_second': 3.141, 'epoch': 26.0}
{'loss': 0.0428, 'learning_rate': 6.5625e-06, 'epoch': 27.0}
{'eval_loss': 4.6133809089660645, 'eval_runtime': 46.1761, 'eval_samples_per_second': 50.199, 'eval_steps_per_second': 3.14, 'epoch': 27.0}
{'loss': 0.0431, 'learning_rate': 4.375e-06, 'epoch': 28.0}
{'eval_loss': 4.619683265686035, 'eval_runtime': 46.1792, 'eval_samples_per_second': 50.196, 'eval_steps_per_second': 3.14, 'epoch': 28.0}
{'loss': 0.0399, 'learning_rate': 2.1875e-06, 'epoch': 29.0}
{'eval_loss': 4.632275581359863, 'eval_runtime': 46.1717, 'eval_samples_per_second': 50.204, 'eval_steps_per_second': 3.14, 'epoch': 29.0}
{'loss': 0.038, 'learning_rate': 0.0, 'epoch': 30.0}
{'eval_loss': 4.639728546142578, 'eval_runtime': 46.1826, 'eval_samples_per_second': 50.192, 'eval_steps_per_second': 3.14, 'epoch': 30.0}
{'train_runtime': 3167.8625, 'train_samples_per_second': 6.231, 'train_steps_per_second': 0.398, 'train_loss': 0.7676589992311266, 'epoch': 30.0}
2022-07-08 14:04:33,145 | __main__ | INFO | Saving trained model...
2022-07-08 14:04:39,035 | __main__ | INFO | Completed!
