Fri Jul  8 13:32:10 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  A100-PCIE-40GB      On   | 00000000:1E:00.0 Off |                    0 |
| N/A   27C    P0    40W / 250W |      0MiB / 40537MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
{'dataset': {'custom': False,
             'name': 'in_conversation_corpus_poc',
             'train_path': 'data/datasets/processed/ICC/julia_dissertation/train.txt',
             'val_path': 'data/datasets/processed/ICC/julia_dissertation/validation.txt'},
 'env': {'seed': None},
 'name': '1.0-GPT-Finetune-TextDataset-HPC',
 'results': {'reports_dir': 'data/models/1.0-GPT-Finetune-TextDataset-HPC/textDataset',
             'save_dir': 'data/models/1.0-GPT-Finetune-TextDataset-HPC/textDataset'},
 'root': '/cluster/tufts/deruiterlab/mumair01/projects/gpt_monologue_dialogue',
 'training': {'data_block_size': 128,
              'model_checkpoint': 'gpt2-large',
              'num_train_epochs': 30,
              'per_device_eval_batch_size': 16,
              'per_device_train_batch_size': 16,
              'tokenizer_additional_special_tokens': ['<SP1>',
                                                      '<SP2>',
                                                      '<START>',
                                                      '<END>'],
              'tokenizer_checkpoint': 'gpt2',
              'warmup_steps': 300}}
2022-07-08 13:32:24,654 | __main__ | INFO | Using device cuda
2022-07-08 13:32:24,654 | __main__ | INFO | Loading tokenizer: gpt2
2022-07-08 13:32:25,698 | __main__ | INFO | Loading data as TextDataset...
2022-07-08 13:32:25,698 | __main__ | WARNING | TextDataset expects .txt files.
2022-07-08 13:32:25,893 | __main__ | INFO | Tokenizer length after loading datasets: 50262
2022-07-08 13:32:25,893 | __main__ | INFO | Creating data collator.
2022-07-08 13:32:25,893 | __main__ | INFO | Loading model: gpt2-large
2022-07-08 13:32:36,774 | __main__ | INFO | Resizing model embeddings to 50262
2022-07-08 13:32:37,629 | __main__ | INFO | Preparing training arguments.
2022-07-08 13:32:37,633 | __main__ | INFO | Initializing Trainer
2022-07-08 13:32:47,111 | __main__ | INFO | Clearing CUDA cache
2022-07-08 13:32:47,576 | __main__ | INFO | Starting training...
{'loss': 4.1654, 'learning_rate': 7.000000000000001e-06, 'epoch': 1.0}
{'eval_loss': 2.909264326095581, 'eval_runtime': 11.4029, 'eval_samples_per_second': 203.282, 'eval_steps_per_second': 12.716, 'epoch': 1.0}
{'loss': 2.7946, 'learning_rate': 1.4000000000000001e-05, 'epoch': 2.0}
{'eval_loss': 2.7366647720336914, 'eval_runtime': 11.4539, 'eval_samples_per_second': 202.377, 'eval_steps_per_second': 12.659, 'epoch': 2.0}
{'loss': 2.5743, 'learning_rate': 2.1e-05, 'epoch': 3.0}
{'eval_loss': 2.6547951698303223, 'eval_runtime': 11.4968, 'eval_samples_per_second': 201.621, 'eval_steps_per_second': 12.612, 'epoch': 3.0}
{'loss': 2.3318, 'learning_rate': 2.8000000000000003e-05, 'epoch': 4.0}
{'eval_loss': 2.6487462520599365, 'eval_runtime': 11.5177, 'eval_samples_per_second': 201.255, 'eval_steps_per_second': 12.589, 'epoch': 4.0}
{'loss': 2.0736, 'learning_rate': 3.5e-05, 'epoch': 5.0}
{'eval_loss': 2.717071294784546, 'eval_runtime': 11.5381, 'eval_samples_per_second': 200.899, 'eval_steps_per_second': 12.567, 'epoch': 5.0}
{'loss': 1.7861, 'learning_rate': 4.2e-05, 'epoch': 6.0}
{'eval_loss': 2.842310905456543, 'eval_runtime': 11.5556, 'eval_samples_per_second': 200.596, 'eval_steps_per_second': 12.548, 'epoch': 6.0}
{'loss': 1.4816, 'learning_rate': 4.9e-05, 'epoch': 7.0}
{'eval_loss': 2.9592089653015137, 'eval_runtime': 11.5528, 'eval_samples_per_second': 200.644, 'eval_steps_per_second': 12.551, 'epoch': 7.0}
{'loss': 1.1828, 'learning_rate': 4.8125000000000004e-05, 'epoch': 8.0}
{'eval_loss': 3.1562111377716064, 'eval_runtime': 11.5374, 'eval_samples_per_second': 200.912, 'eval_steps_per_second': 12.568, 'epoch': 8.0}
{'loss': 0.9138, 'learning_rate': 4.59375e-05, 'epoch': 9.0}
{'eval_loss': 3.295015335083008, 'eval_runtime': 11.5669, 'eval_samples_per_second': 200.4, 'eval_steps_per_second': 12.536, 'epoch': 9.0}
{'loss': 0.6944, 'learning_rate': 4.375e-05, 'epoch': 10.0}
{'eval_loss': 3.4335122108459473, 'eval_runtime': 11.5573, 'eval_samples_per_second': 200.566, 'eval_steps_per_second': 12.546, 'epoch': 10.0}
{'loss': 0.5282, 'learning_rate': 4.156250000000001e-05, 'epoch': 11.0}
{'eval_loss': 3.572190284729004, 'eval_runtime': 11.5526, 'eval_samples_per_second': 200.647, 'eval_steps_per_second': 12.551, 'epoch': 11.0}
{'loss': 0.4038, 'learning_rate': 3.9375e-05, 'epoch': 12.0}
{'eval_loss': 3.7236876487731934, 'eval_runtime': 11.575, 'eval_samples_per_second': 200.259, 'eval_steps_per_second': 12.527, 'epoch': 12.0}
{'loss': 0.3077, 'learning_rate': 3.71875e-05, 'epoch': 13.0}
{'eval_loss': 3.8626797199249268, 'eval_runtime': 11.5528, 'eval_samples_per_second': 200.644, 'eval_steps_per_second': 12.551, 'epoch': 13.0}
{'loss': 0.2427, 'learning_rate': 3.5e-05, 'epoch': 14.0}
{'eval_loss': 3.9659175872802734, 'eval_runtime': 11.5416, 'eval_samples_per_second': 200.839, 'eval_steps_per_second': 12.563, 'epoch': 14.0}
{'loss': 0.1988, 'learning_rate': 3.2812500000000005e-05, 'epoch': 15.0}
{'eval_loss': 4.044775485992432, 'eval_runtime': 11.542, 'eval_samples_per_second': 200.833, 'eval_steps_per_second': 12.563, 'epoch': 15.0}
{'loss': 0.1636, 'learning_rate': 3.0625000000000006e-05, 'epoch': 16.0}
{'eval_loss': 4.105706214904785, 'eval_runtime': 11.539, 'eval_samples_per_second': 200.883, 'eval_steps_per_second': 12.566, 'epoch': 16.0}
{'loss': 0.14, 'learning_rate': 2.84375e-05, 'epoch': 17.0}
{'eval_loss': 4.18519401550293, 'eval_runtime': 11.5409, 'eval_samples_per_second': 200.851, 'eval_steps_per_second': 12.564, 'epoch': 17.0}
{'loss': 0.1165, 'learning_rate': 2.625e-05, 'epoch': 18.0}
{'eval_loss': 4.258480072021484, 'eval_runtime': 11.5494, 'eval_samples_per_second': 200.703, 'eval_steps_per_second': 12.555, 'epoch': 18.0}
{'loss': 0.1005, 'learning_rate': 2.4062500000000002e-05, 'epoch': 19.0}
{'eval_loss': 4.34736442565918, 'eval_runtime': 11.5705, 'eval_samples_per_second': 200.338, 'eval_steps_per_second': 12.532, 'epoch': 19.0}
{'loss': 0.0869, 'learning_rate': 2.1875e-05, 'epoch': 20.0}
{'eval_loss': 4.404170513153076, 'eval_runtime': 11.5573, 'eval_samples_per_second': 200.566, 'eval_steps_per_second': 12.546, 'epoch': 20.0}
{'loss': 0.0768, 'learning_rate': 1.96875e-05, 'epoch': 21.0}
{'eval_loss': 4.407803058624268, 'eval_runtime': 11.5599, 'eval_samples_per_second': 200.521, 'eval_steps_per_second': 12.543, 'epoch': 21.0}
{'loss': 0.0676, 'learning_rate': 1.75e-05, 'epoch': 22.0}
{'eval_loss': 4.457082748413086, 'eval_runtime': 11.545, 'eval_samples_per_second': 200.78, 'eval_steps_per_second': 12.56, 'epoch': 22.0}
{'loss': 0.0592, 'learning_rate': 1.5312500000000003e-05, 'epoch': 23.0}
{'eval_loss': 4.513182163238525, 'eval_runtime': 11.5551, 'eval_samples_per_second': 200.604, 'eval_steps_per_second': 12.549, 'epoch': 23.0}
{'loss': 0.0544, 'learning_rate': 1.3125e-05, 'epoch': 24.0}
{'eval_loss': 4.529244422912598, 'eval_runtime': 11.5651, 'eval_samples_per_second': 200.431, 'eval_steps_per_second': 12.538, 'epoch': 24.0}
{'loss': 0.0491, 'learning_rate': 1.09375e-05, 'epoch': 25.0}
{'eval_loss': 4.5579376220703125, 'eval_runtime': 11.5716, 'eval_samples_per_second': 200.318, 'eval_steps_per_second': 12.531, 'epoch': 25.0}
{'loss': 0.0466, 'learning_rate': 8.75e-06, 'epoch': 26.0}
{'eval_loss': 4.600864887237549, 'eval_runtime': 11.5731, 'eval_samples_per_second': 200.292, 'eval_steps_per_second': 12.529, 'epoch': 26.0}
{'loss': 0.0427, 'learning_rate': 6.5625e-06, 'epoch': 27.0}
{'eval_loss': 4.6214375495910645, 'eval_runtime': 11.5531, 'eval_samples_per_second': 200.639, 'eval_steps_per_second': 12.551, 'epoch': 27.0}
{'loss': 0.0405, 'learning_rate': 4.375e-06, 'epoch': 28.0}
{'eval_loss': 4.628949165344238, 'eval_runtime': 11.568, 'eval_samples_per_second': 200.381, 'eval_steps_per_second': 12.535, 'epoch': 28.0}
{'loss': 0.0396, 'learning_rate': 2.1875e-06, 'epoch': 29.0}
{'eval_loss': 4.644840717315674, 'eval_runtime': 11.5693, 'eval_samples_per_second': 200.358, 'eval_steps_per_second': 12.533, 'epoch': 29.0}
{'loss': 0.038, 'learning_rate': 0.0, 'epoch': 30.0}
{'eval_loss': 4.64622163772583, 'eval_runtime': 11.549, 'eval_samples_per_second': 200.711, 'eval_steps_per_second': 12.555, 'epoch': 30.0}
{'train_runtime': 1343.1109, 'train_samples_per_second': 14.697, 'train_steps_per_second': 0.938, 'train_loss': 0.7600462415861705, 'epoch': 30.0}
2022-07-08 13:55:10,699 | __main__ | INFO | Saving trained model...
2022-07-08 13:55:17,717 | __main__ | INFO | Completed!
