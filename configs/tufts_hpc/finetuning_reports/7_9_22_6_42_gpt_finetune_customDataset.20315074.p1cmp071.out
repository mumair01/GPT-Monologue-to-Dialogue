Sat Jul  9 18:46:18 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.80.02    Driver Version: 450.80.02    CUDA Version: 11.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-PCIE...  On   | 00000000:AF:00.0 Off |                    0 |
| N/A   29C    P0    22W / 250W |      0MiB / 32510MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
{'dataset': {'custom': True,
             'name': 'ICC',
             'train_path': 'data/datasets/processed/ICC/julia_dissertation/train.csv',
             'val_path': 'data/datasets/processed/ICC/julia_dissertation/validation.csv'},
 'env': {'seed': None},
 'name': 'gpt2_large_ICC_attempt_1',
 'results': {'reports_dir': 'data/models/2.0-GPT-Finetune-CustomDataset-HPC/',
             'save_dir': 'data/models/2.0-GPT-Finetune-CustomDataset-HPC/'},
 'root': '/cluster/tufts/deruiterlab/mumair01/projects/gpt_monologue_dialogue',
 'training': {'data_block_size': 128,
              'model_checkpoint': 'gpt2-large',
              'num_train_epochs': 30,
              'per_device_eval_batch_size': 16,
              'per_device_train_batch_size': 16,
              'tokenizer_additional_special_tokens': ['<SP1>',
                                                      '<SP2>',
                                                      '<START>',
                                                      '<END>'],
              'tokenizer_checkpoint': 'gpt2',
              'warmup_steps': 300}}
2022-07-09 18:46:24,126 | __main__ | INFO | Using device cuda
2022-07-09 18:46:24,126 | __main__ | INFO | Loading tokenizer: gpt2
2022-07-09 18:46:25,014 | __main__ | INFO | Loading data as custom dataset...
2022-07-09 18:46:25,014 | __main__ | WARNING | Custom dataset expects .csv files.
2022-07-09 18:46:27,006 | __main__ | INFO | Tokenizer length after loading datasets: 50262
2022-07-09 18:46:27,006 | __main__ | INFO | Creating data collator.
2022-07-09 18:46:27,006 | __main__ | INFO | Loading model: gpt2-large
2022-07-09 18:46:33,456 | __main__ | INFO | Resizing model embeddings to 50262
2022-07-09 18:46:34,153 | __main__ | INFO | Preparing training arguments.
2022-07-09 18:46:34,155 | __main__ | INFO | Initializing Trainer
2022-07-09 18:46:38,160 | __main__ | INFO | Clearing CUDA cache
2022-07-09 18:46:38,251 | __main__ | INFO | Starting training...
{'loss': 4.6479, 'learning_rate': 6.333333333333334e-06, 'epoch': 1.0}
{'eval_loss': 3.262183666229248, 'eval_runtime': 42.0119, 'eval_samples_per_second': 50.2, 'eval_steps_per_second': 3.142, 'epoch': 1.0}
{'loss': 3.1052, 'learning_rate': 1.2666666666666668e-05, 'epoch': 2.0}
{'eval_loss': 2.991088628768921, 'eval_runtime': 42.2037, 'eval_samples_per_second': 49.972, 'eval_steps_per_second': 3.128, 'epoch': 2.0}
{'loss': 2.842, 'learning_rate': 1.9e-05, 'epoch': 3.0}
{'eval_loss': 2.931009531021118, 'eval_runtime': 42.2077, 'eval_samples_per_second': 49.967, 'eval_steps_per_second': 3.127, 'epoch': 3.0}
{'loss': 2.6128, 'learning_rate': 2.5333333333333337e-05, 'epoch': 4.0}
{'eval_loss': 2.9383749961853027, 'eval_runtime': 42.2194, 'eval_samples_per_second': 49.953, 'eval_steps_per_second': 3.127, 'epoch': 4.0}
{'loss': 2.3417, 'learning_rate': 3.1666666666666666e-05, 'epoch': 5.0}
{'eval_loss': 2.9440886974334717, 'eval_runtime': 42.2475, 'eval_samples_per_second': 49.92, 'eval_steps_per_second': 3.124, 'epoch': 5.0}
{'loss': 2.0447, 'learning_rate': 3.8e-05, 'epoch': 6.0}
{'eval_loss': 3.039717197418213, 'eval_runtime': 42.2361, 'eval_samples_per_second': 49.934, 'eval_steps_per_second': 3.125, 'epoch': 6.0}
{'loss': 1.741, 'learning_rate': 4.433333333333334e-05, 'epoch': 7.0}
{'eval_loss': 3.2029004096984863, 'eval_runtime': 42.2835, 'eval_samples_per_second': 49.878, 'eval_steps_per_second': 3.122, 'epoch': 7.0}
{'loss': 1.431, 'learning_rate': 4.976190476190477e-05, 'epoch': 8.0}
{'eval_loss': 3.3957018852233887, 'eval_runtime': 42.252, 'eval_samples_per_second': 49.915, 'eval_steps_per_second': 3.124, 'epoch': 8.0}
{'loss': 1.144, 'learning_rate': 4.75e-05, 'epoch': 9.0}
{'eval_loss': 3.508765459060669, 'eval_runtime': 42.2481, 'eval_samples_per_second': 49.919, 'eval_steps_per_second': 3.124, 'epoch': 9.0}
{'loss': 0.8865, 'learning_rate': 4.523809523809524e-05, 'epoch': 10.0}
{'eval_loss': 3.711061477661133, 'eval_runtime': 42.2403, 'eval_samples_per_second': 49.929, 'eval_steps_per_second': 3.125, 'epoch': 10.0}
{'loss': 0.6788, 'learning_rate': 4.297619047619048e-05, 'epoch': 11.0}
{'eval_loss': 3.8137872219085693, 'eval_runtime': 42.2718, 'eval_samples_per_second': 49.891, 'eval_steps_per_second': 3.123, 'epoch': 11.0}
{'loss': 0.5184, 'learning_rate': 4.0714285714285717e-05, 'epoch': 12.0}
{'eval_loss': 3.9866907596588135, 'eval_runtime': 42.2575, 'eval_samples_per_second': 49.908, 'eval_steps_per_second': 3.124, 'epoch': 12.0}
{'loss': 0.4029, 'learning_rate': 3.845238095238096e-05, 'epoch': 13.0}
{'eval_loss': 4.110971927642822, 'eval_runtime': 42.2525, 'eval_samples_per_second': 49.914, 'eval_steps_per_second': 3.124, 'epoch': 13.0}
{'loss': 0.3091, 'learning_rate': 3.619047619047619e-05, 'epoch': 14.0}
{'eval_loss': 4.229941368103027, 'eval_runtime': 42.2449, 'eval_samples_per_second': 49.923, 'eval_steps_per_second': 3.125, 'epoch': 14.0}
{'loss': 0.2447, 'learning_rate': 3.392857142857143e-05, 'epoch': 15.0}
{'eval_loss': 4.354903221130371, 'eval_runtime': 42.2354, 'eval_samples_per_second': 49.934, 'eval_steps_per_second': 3.125, 'epoch': 15.0}
{'loss': 0.2015, 'learning_rate': 3.1666666666666666e-05, 'epoch': 16.0}
{'eval_loss': 4.381674766540527, 'eval_runtime': 42.2422, 'eval_samples_per_second': 49.926, 'eval_steps_per_second': 3.125, 'epoch': 16.0}
{'loss': 0.1717, 'learning_rate': 2.940476190476191e-05, 'epoch': 17.0}
{'eval_loss': 4.468000888824463, 'eval_runtime': 42.2569, 'eval_samples_per_second': 49.909, 'eval_steps_per_second': 3.124, 'epoch': 17.0}
{'loss': 0.1432, 'learning_rate': 2.714285714285714e-05, 'epoch': 18.0}
{'eval_loss': 4.57026481628418, 'eval_runtime': 42.25, 'eval_samples_per_second': 49.917, 'eval_steps_per_second': 3.124, 'epoch': 18.0}
{'loss': 0.1211, 'learning_rate': 2.4880952380952383e-05, 'epoch': 19.0}
{'eval_loss': 4.620541095733643, 'eval_runtime': 42.2685, 'eval_samples_per_second': 49.895, 'eval_steps_per_second': 3.123, 'epoch': 19.0}
{'loss': 0.1061, 'learning_rate': 2.261904761904762e-05, 'epoch': 20.0}
{'eval_loss': 4.666787147521973, 'eval_runtime': 42.2425, 'eval_samples_per_second': 49.926, 'eval_steps_per_second': 3.125, 'epoch': 20.0}
{'loss': 0.0917, 'learning_rate': 2.0357142857142858e-05, 'epoch': 21.0}
{'eval_loss': 4.759725093841553, 'eval_runtime': 42.2591, 'eval_samples_per_second': 49.906, 'eval_steps_per_second': 3.124, 'epoch': 21.0}
{'loss': 0.0793, 'learning_rate': 1.8095238095238094e-05, 'epoch': 22.0}
{'eval_loss': 4.813045978546143, 'eval_runtime': 42.2656, 'eval_samples_per_second': 49.899, 'eval_steps_per_second': 3.123, 'epoch': 22.0}
{'loss': 0.0697, 'learning_rate': 1.5833333333333333e-05, 'epoch': 23.0}
{'eval_loss': 4.844466686248779, 'eval_runtime': 42.2633, 'eval_samples_per_second': 49.901, 'eval_steps_per_second': 3.123, 'epoch': 23.0}
{'loss': 0.062, 'learning_rate': 1.357142857142857e-05, 'epoch': 24.0}
{'eval_loss': 4.892565727233887, 'eval_runtime': 42.2782, 'eval_samples_per_second': 49.884, 'eval_steps_per_second': 3.122, 'epoch': 24.0}
{'loss': 0.0553, 'learning_rate': 1.130952380952381e-05, 'epoch': 25.0}
{'eval_loss': 4.9359893798828125, 'eval_runtime': 42.2776, 'eval_samples_per_second': 49.885, 'eval_steps_per_second': 3.122, 'epoch': 25.0}
{'loss': 0.0518, 'learning_rate': 9.047619047619047e-06, 'epoch': 26.0}
{'eval_loss': 4.926535606384277, 'eval_runtime': 42.2854, 'eval_samples_per_second': 49.875, 'eval_steps_per_second': 3.122, 'epoch': 26.0}
{'loss': 0.0467, 'learning_rate': 6.785714285714285e-06, 'epoch': 27.0}
{'eval_loss': 4.959761142730713, 'eval_runtime': 42.2835, 'eval_samples_per_second': 49.878, 'eval_steps_per_second': 3.122, 'epoch': 27.0}
{'loss': 0.0442, 'learning_rate': 4.5238095238095235e-06, 'epoch': 28.0}
{'eval_loss': 4.989546775817871, 'eval_runtime': 42.287, 'eval_samples_per_second': 49.873, 'eval_steps_per_second': 3.122, 'epoch': 28.0}
{'loss': 0.0415, 'learning_rate': 2.2619047619047617e-06, 'epoch': 29.0}
{'eval_loss': 4.9991631507873535, 'eval_runtime': 42.2818, 'eval_samples_per_second': 49.88, 'eval_steps_per_second': 3.122, 'epoch': 29.0}
{'loss': 0.0402, 'learning_rate': 0.0, 'epoch': 30.0}
{'eval_loss': 4.99745512008667, 'eval_runtime': 42.2956, 'eval_samples_per_second': 49.863, 'eval_steps_per_second': 3.121, 'epoch': 30.0}
{'train_runtime': 2945.2878, 'train_samples_per_second': 6.091, 'train_steps_per_second': 0.387, 'train_loss': 0.8758940059887735, 'epoch': 30.0}
2022-07-09 19:35:43,548 | __main__ | INFO | Saving trained model...
2022-07-09 19:35:49,630 | __main__ | INFO | Completed!
